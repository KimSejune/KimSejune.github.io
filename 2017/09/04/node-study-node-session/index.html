<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>Node-Session | KimSejune Start Study</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="Node.js,Session" />
    
    <meta name="description" content="Node SessionSession사전적 의미 (특정한 활동을 위한) 시간 (의회 등의)회기; (법정의) 개정 (기간)  실질적 의미시작 조건과 종료조건이 있는 시간, 또는 회기정보 교환이 지속되는 시간, 또는 회기 세션의 예 HTTP session요청 - 응답    클라이언트가 TCP 연결을 수립합니다(또는 전송 계층이 TCP가 아닌 다른 적당한 연결로">
<meta name="keywords" content="Node.js,Session">
<meta property="og:type" content="article">
<meta property="og:title" content="Node-Session">
<meta property="og:url" content="http://yoursite.com/2017/09/04/node-study-node-session/index.html">
<meta property="og:site_name" content="KimSejune Start Study">
<meta property="og:description" content="Node SessionSession사전적 의미 (특정한 활동을 위한) 시간 (의회 등의)회기; (법정의) 개정 (기간)  실질적 의미시작 조건과 종료조건이 있는 시간, 또는 회기정보 교환이 지속되는 시간, 또는 회기 세션의 예 HTTP session요청 - 응답    클라이언트가 TCP 연결을 수립합니다(또는 전송 계층이 TCP가 아닌 다른 적당한 연결로">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://yoursite.com/images/nodejs.png">
<meta property="og:updated_time" content="2017-09-16T11:12:55.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Node-Session">
<meta name="twitter:description" content="Node SessionSession사전적 의미 (특정한 활동을 위한) 시간 (의회 등의)회기; (법정의) 개정 (기간)  실질적 의미시작 조건과 종료조건이 있는 시간, 또는 회기정보 교환이 지속되는 시간, 또는 회기 세션의 예 HTTP session요청 - 응답    클라이언트가 TCP 연결을 수립합니다(또는 전송 계층이 TCP가 아닌 다른 적당한 연결로">
<meta name="twitter:image" content="http://yoursite.com/images/nodejs.png">
    

    

    
        <link rel="icon" href="/images/logo.png" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    


</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">Node.js JavaScript</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/CSS/">CSS</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/CSS/Selector/">Selector</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/CSS/Syntax/">Syntax</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/">JavaScript</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Control-Flow/">Control Flow</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Data-Type/">Data-Type</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Function/">Function</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Immutability/">Immutability</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Introduction/">Introduction</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Object/">Object</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Operator/">Operator</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Prototype/">Prototype</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/JavaScript/Syntax/">Syntax</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/">Node.js</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Ajax/">Ajax</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/CORS/">CORS</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/CSRF/">CSRF</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Cookie/">Cookie</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/DataModeling/">DataModeling</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Database/">Database</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Elasticache/">Elasticache</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Express/">Express</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Express-Middlware/">Express-Middlware</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Fetch/">Fetch</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/GraphQL/">GraphQL</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Http/">Http</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/JWT/">JWT</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Linux/">Linux</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/OAuth/">OAuth</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Passport/">Passport</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Rest-API/">Rest-API</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/SPA/">SPA</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Service-Develop/">Service Develop</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Session/">Session</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/SocketIO/">SocketIO</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Template-Language/">Template Language</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Testablility/">Testablility</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/Web-Form/">Web Form</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/http-cache/">http-cache</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/knex/">knex</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/kue/">kue</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Node-js/mongoDB/">mongoDB</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Project/">Project</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Project/ReadMe/">ReadMe</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Project/redis/">redis</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="https://github.com/KimSejune">About</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Node-js/">Node.js</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/categories/Node-js/Session/">Session</a>
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-node-study-node-session" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        Node-Session
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2017/09/04/node-study-node-session/" class="article-date">
            <time datetime="2017-09-04T03:54:00.000Z" itemprop="datePublished">2017-09-04</time>
        </a>
    </div>

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Node-js/">Node.js</a>, <a class="tag-link" href="/tags/Session/">Session</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p><img src="/images/nodejs.png" alt="nodejs"></p>
<h1 id="Node-Session"><a href="#Node-Session" class="headerlink" title="Node Session"></a>Node Session</h1><h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><h3 id="사전적-의미"><a href="#사전적-의미" class="headerlink" title="사전적 의미"></a>사전적 의미</h3><ol>
<li>(특정한 활동을 위한) 시간</li>
<li>(의회 등의)회기; (법정의) 개정 (기간)</li>
</ol>
<h3 id="실질적-의미"><a href="#실질적-의미" class="headerlink" title="실질적 의미"></a>실질적 의미</h3><p><code>시작 조건</code>과 <code>종료조건</code>이 있는 시간, 또는 회기<br><code>정보 교환이 지속</code>되는 시간, 또는 회기</p>
<h2 id="세션의-예"><a href="#세션의-예" class="headerlink" title="세션의 예"></a>세션의 예</h2><ul>
<li><p><a href="https://developer.mozilla.org/ko/docs/Web/HTTP/Session" target="_blank" rel="external"><code>HTTP session</code></a><br>요청 - 응답  </p>
<ul>
<li>클라이언트가 TCP 연결을 수립합니다(또는 전송 계층이 TCP가 아닌 다른 적당한 연결로).  </li>
<li>클라이언트는 요청을 전송한 뒤 응답을 기다립니다.  </li>
<li>서버는 요청에 대해 처리하고 그에 대한 응답을 상태 코드 그리고 요청에 부합하는 데이터와 함께 돌려보냅니다.  </li>
</ul>
</li>
<li><p><a href="https://en.wikipedia.org/wiki/Login_session" target="_blank" rel="external"><code>로그인 세션</code></a><br>로그인 - 로그아웃  </p>
</li>
<li><p><a href="https://support.google.com/analytics/answer/2731565?hl=ko" target="_blank" rel="external"><code>Google Analytics 세션</code></a><br>페이지 접속 - 30분간 접속이 없으면 종료로 간주 (커스터마이징 가능)  </p>
</li>
</ul>
<h2 id="웹-서비스를-위한-세션의-구현"><a href="#웹-서비스를-위한-세션의-구현" class="headerlink" title="웹 서비스를 위한 세션의 구현"></a>웹 서비스를 위한 세션의 구현</h2><ol>
<li>세션이 시작되면, <code>세션이 시작되었다는 사실을 쿠키에 저장</code></li>
<li>세션에 대한 정보를 여러 요청에 걸쳐서 지속시키기 위해, 정보를 <code>어딘가에 저장</code></li>
<li>세션이 만료되면, <code>세션이 만료되었다는 사실을 쿠키에 반영</code>  </li>
</ol>
<ul>
<li>위 방식은 널리 사용되는 방식일 뿐, 반드시 위와 같이 구현해야 하는 것은 아닙니다.</li>
</ul>
<h2 id="세션-스토어"><a href="#세션-스토어" class="headerlink" title="세션 스토어"></a>세션 스토어</h2><p>세션에 대한 정보를 저장하는 어딘가</p>
<ul>
<li>쿠키  </li>
<li>데이터베이스  </li>
<li>파일  </li>
<li>기타 정보를 저장할 수 있는 곳 어디든  </li>
</ul>
<h2 id="세션-스토어의-선택"><a href="#세션-스토어의-선택" class="headerlink" title="세션 스토어의 선택"></a>세션 스토어의 선택</h2><p><code>서비스의 요구사항</code>에 맞춰서 <code>적절한 저장소를 선택</code>하면 됨</p>
<ul>
<li>정보의 형태가 간단하고 자주 바뀔 일이 없으면 <code>쿠키</code>  </li>
<li>저장해야 할 정보의 양이 많으면 <code>데이터베이스</code>  </li>
<li>정보가 굉장히 자주 변경되면 <code>메모리 기반 저장소</code>  </li>
</ul>
<h2 id="세션-세션-스토어"><a href="#세션-세션-스토어" class="headerlink" title="세션? 세션 스토어?"></a>세션? 세션 스토어?</h2><p><code>&#39;세션&#39;</code>과 <code>&#39;세션 스토어&#39;</code>는 엄연히 다른 말이지만 혼용되는 경우가 많습니다.  </p>
<p><code>&#39;세션에 정보를 저장한다&#39;</code>는 말은 <code>&#39;세션 스토어에 정보를 저장한다&#39;</code>는 말과 같은 뜻이라고 생각하면 됩니다.  </p>
<h2 id="Express-Session"><a href="#Express-Session" class="headerlink" title="Express + Session"></a>Express + Session</h2><p><code>cookie-session</code>  </p>
<ul>
<li>쿠키에 모든 정보를 저장하는 세션 스토어.   </li>
<li>첫 방문시 무조건 세션 시작<br><code>express-session</code></li>
<li>쿠키에는 세션 식별자만 저장하고 실제 정보의 저장은 외부 저장소(데이터베이스 등)를 이용하는 세션 스토어. 외부 저장소에 대한 별도의 설정 필요</li>
</ul>
<h2 id="cookie-session-예제"><a href="#cookie-session-예제" class="headerlink" title="cookie-session 예제"></a>cookie-session 예제</h2><p><a href="https://glitch.com/edit/#!/wpsn-cookie-session-example" target="_blank" rel="external">Link</a>  </p>
<p>cookie-session NPM 패키지는 쿠키를 세션 스토어로 사용할 수 있도록 해주며 세션 스토어를 쉽게 사용할 수 있는 방법을 제공합니다.  </p>
<p>server.js 파일과 앱을 열어 어떤 방식으로 동작하는 앱인지 확인하고, 크롬 개발자 도구를 이용해 쿠키가 전달되고 저장되는 모습을 확인하세요.  </p>
<h2 id="cookie-session-동작-방식"><a href="#cookie-session-동작-방식" class="headerlink" title="cookie-session 동작 방식"></a>cookie-session 동작 방식</h2><ol>
<li>cookie-session 미들웨어는 첫 요청이 일어났을 때 빈 세션 정보(빈 객체)를 req.session에 주입합니다.  </li>
<li>프로그래머는 세션과 관련된 정보를 req.session에 저장합니다. <code>req.session은 보통의 자바스크립트 객체로, JSON으로 표현될 수 있는 자료라면 뭐든지 저장</code>할 수 있습니다.  </li>
<li>cookie-session 미들웨어는 응답이 일어나기 직전에 req.session 객체를 문자열로 바꾼 뒤(JSON &amp; base64), 쿠키에 저장합니다.  </li>
<li>cookie-session 미들웨어는 다음 번 요청부터 쿠키에 저장된 정보를 자바스크립트 객체로 변환해 req.session에 주입합니다.  </li>
<li>프로그래머는 req.session 객체를 이용해 세션 정보를 읽을 수 있습니다. 또한 <code>세션 정보를 통째로 삭제</code>하기 위해 미들웨어 또는 라우트 핸들러에서 <code>req.session = null</code>을 대입할 수 있습니다.  </li>
</ol>
<h2 id="session-sig-서명"><a href="#session-sig-서명" class="headerlink" title="session.sig? 서명!"></a>session.sig? 서명!</h2><p>session 쿠키에 저장된 정보는 일반인은 알아볼 수 없지만 프로그래머라면 쉽게 복원하거나 변경할 수 있습니다. (base64 디코더로 session 쿠키를 변환해보세요) 만약에 세션에 <code>계정 정보</code>가 들어있고, 악의적인 해커가 쿠키의 값을 변경해서 세션 스토어를 <code>조작</code>할 수 있다면, 마치 다른 사람인 척 행세할 수 있고 그에 따라 정보를 탈취당할 수도 있을 것입니다.  </p>
<p>그래서, cookie-session 미들웨어는 보안 유지를 위해 서명(signature)을 활용하고 있습니다. 컴퓨터 분야에서의 서명이란, 비밀 키를 이용해 정보를 특별한 알고리즘(hashing)으로 변형시킨 것을 말합니다. 서명의 가장 중요한 성질은, 같은 비밀 키로 같은 정보를 서명했을 때 언제나 같은 결과가 나온다는 것, 그리고 비밀 키나 정보 중 어느 한 쪽만 바뀌어도 서명의 결과가 크게 달라진다는 것입니다.  </p>
<p>비밀 키와 서명을 활용하면 <code>정보가 조작되었는지의 여부를 알 수 있습니다.</code> 어떤 정보를 서명과 함께 공개하고 비밀 키는 숨기면, 누군가가 정보를 조작해서 올바른 정보인 척 흉내를 내려고 해도 비밀 키를 모르기 때문에 서명을 할 수 없어서 금방 조작인 것이 탄로가 나겠죠.  </p>
<p>cookie-session 미들웨어는 응답을 보낼 때 session 쿠키에 저장된 문자열을 비밀 키로 서명해서 그 결과를 session.sig 쿠키에 저장합니다. 만약에 요청에 포함된 session 쿠키를 다시 같은 비밀 키로 서명했는데 session.sig 쿠키와 일치하지 않는다면, 정보가 조작된 것을 알아채고 세션을 아예 삭제해버리는 방식으로 조작을 막습니다!  </p>
<p>서명을 활용할 때 주의할 점이 있습니다.  </p>
<ol>
<li>비밀 키는 당연히 공개되지 않도록 관리해야 합니다. 비밀 키와 서명 알고리즘이 공개되면 서명이 조작될 수 있습니다.  </li>
<li>키의 길이를 충분히 길게 해야 합니다. 해커가 서명 알고리즘을 알고 있다면, 짧은 비밀 키는 어렵지 않게 계산해낼 수 있습니다.  </li>
<li>서명은 정보의 조작을 막아주지만, 정보의 공개를 막아주지는 않습니다. session 쿠키만 하더라도 base64 디코딩만 거치면 어떤 정보가 들어있는지 바로 확인할 수 있죠. 따라서 비밀번호나 신용카드 번호 등은 cookie-session이 제공하는 세션 스토어에 저장하면 안 됩니다.  </li>
</ol>
<p>참고로, 이전에 다뤘던 cookie-parser 미들웨어도 옵션을 활성화하면 서명을 사용하여 조작을 방지할 수 있습니다. 곧 배울 JWT도 보안을 위해 서명을 사용하고 있습니다.  </p>
<p>서명 과정을 직접 시험해보고 싶다면 <a href="://www.npmjs.com/package/keygrip">여기</a>를 참고하세요.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"><span class="keyword">const</span> cookieSession = <span class="built_in">require</span>(<span class="string">'cookie-session'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> app = express()</div><div class="line"></div><div class="line">app.set(<span class="string">'trust proxy'</span>, <span class="number">1</span>) </div><div class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'ejs'</span>)</div><div class="line"></div><div class="line"><span class="comment">// cookie-session 설정</span></div><div class="line"><span class="comment">// name: 쿠키 이름으로 사용할 문자열</span></div><div class="line"><span class="comment">// secret: 세션 정보를 서명할 때 사용할 키</span></div><div class="line"><span class="comment">// 여러가지 옵션을</span></div><div class="line">app.use(cookieSession(&#123;</div><div class="line">  name: <span class="string">'session'</span>,</div><div class="line">  secret: process.env.SECRET</div><div class="line">&#125;))</div><div class="line"></div><div class="line"><span class="comment">// req.session.count를 처리하는 미들웨어</span></div><div class="line"><span class="keyword">const</span> countMiddleware = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (<span class="string">'count'</span> <span class="keyword">in</span> req.session) &#123;</div><div class="line">    <span class="comment">// count 속성이 있으면 1으.</span></div><div class="line">    req.session.count += <span class="number">1</span></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// count 속성이 없으면 처음 방문한 것이므로 1로 설정한다.</span></div><div class="line">    req.session.count = <span class="number">1</span></div><div class="line">  &#125;</div><div class="line">  next()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 첫 방문 후, 쿠키 관련 헤더가 요청과 응답에 잘 포함되는지 살펴보고,</span></div><div class="line"><span class="comment">// 실제로 쿠키가 어떻게 저장되어있는지 살펴보세요.</span></div><div class="line">app.get(<span class="string">'/'</span>, countMiddleware, (req, res) =&gt; &#123;</div><div class="line">  res.render(<span class="string">'index.ejs'</span>, &#123;<span class="attr">count</span>: req.session.count&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.post(<span class="string">'/reset-count'</span>, (req, res) =&gt; &#123;</div><div class="line">  <span class="keyword">delete</span> req.session.count</div><div class="line">  res.redirect(<span class="string">'/'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'listening...'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>req.session에다가 값을 저장하면 cookie value에 값이 저장된다.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">count</span> %&gt;</span>번 째 방문하셨습니다.</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/reset-count"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></div><div class="line">        초기화</div><div class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="인증-Authentication-과-인가-Authorization"><a href="#인증-Authentication-과-인가-Authorization" class="headerlink" title="인증(Authentication)과 인가(Authorization)"></a>인증(Authentication)과 인가(Authorization)</h2><p>인증(Authentication)은 클라이언트가 누구인지를 확인하는 과정입니다. 지금은 ‘인증과 로그인은 같은 말’이라고 생각하셔도 무방합니다.  </p>
<p>인가는 클라이언트가 하려고 하는 작업이 해당 클라이언트에게 허가된 작업인지를 확인하는 과정입니다. ‘권한 설정’이라고 생각하셔도 무방합니다. 예를 들어 다음 카페나 네이버 클럽에서는 관리자만이 게시판을 만들거나 없앨 수 있도록 인가됩니다.  </p>
<h2 id="인증-구현-전략"><a href="#인증-구현-전략" class="headerlink" title="인증 구현 전략"></a>인증 구현 전략</h2><p>인증은 여러가지 방식으로 구현될 수 있으며, 여기에서는 우리가 쓰고 있는 cookie-session 의 기능에 맞추어서 구현해보도록 하겠습니다.  </p>
<p>cookie-session이 제공하는 미들웨어는 첫 방문시 바로 세션을 시작하고 (이를 guest session이라 부릅니다) 쿠키에 빈 세션 정보(빈 객체)를 저장합니다. 그래서 첫 방문자에 대해서도 session 객체를 바로 쓸 수 있습니다.  </p>
<p>아래와 같은 규칙으로 인증을 구현해보도록 합니다.  </p>
<ol>
<li>req.session.username === undefined이면 로그인된 사용자가 없는 것으로 간주합니다.  </li>
<li>사용자가 로그인 폼을 전송하면 accounts 배열에 저장된 계정 정보 중에 일치하는 것이 있는지 확인하고, 있다면 req.session.username에 해당 사용자 이름을 저장합니다. 만약 일치하는 계정이 없으면 400 Bad Request 응답을 보냅니다.  </li>
<li>req.session.username에 저장된 값이 있다면 해당 사용자로 로그인이 되어 있다고 간주합니다.  </li>
<li>로그아웃을 하기 위해 req.session = null와 같이 대입해서 세션을 초기화합니다.  </li>
</ol>
<p>(인증이 된 뒤에는 req.user와 res.locals.user에 계정 객체를 주입해서 라우트 핸들러와 템플릿에서 편하게 접근할 수 있도록 미리 코드를 짜 두었습니다.) </p>
<h2 id="인가-구현-전략"><a href="#인가-구현-전략" class="headerlink" title="인가 구현 전략"></a>인가 구현 전략</h2><p>관리자만이 비밀 정보(/secret)에 접근할 수 있도록 해 보겠습니다. 사용자가 관리자인지 아닌지의 여부는 계정 객체의 admin 속성에 저장되어 있습니다.  </p>
<h2 id="로그인한-정보를-맞는지-확인하여서-값을-찾아낸다"><a href="#로그인한-정보를-맞는지-확인하여서-값을-찾아낸다" class="headerlink" title="로그인한 정보를 맞는지 확인하여서 값을 찾아낸다."></a>로그인한 정보를 맞는지 확인하여서 값을 찾아낸다.</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//server.js</span></div><div class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"><span class="keyword">const</span> cookieSession = <span class="built_in">require</span>(<span class="string">'cookie-session'</span>)</div><div class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> app = express()</div><div class="line"><span class="keyword">const</span> urlencodedMiddleware = bodyParser.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;)</div><div class="line"></div><div class="line">app.set(<span class="string">'trust proxy'</span>, <span class="number">1</span>) </div><div class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'ejs'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> accounts = [</div><div class="line">  &#123;</div><div class="line">    username: <span class="string">'tpwns'</span>,</div><div class="line">    password: <span class="string">'kim'</span>,</div><div class="line">    name: <span class="string">'김세준'</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    username: <span class="string">'fast'</span>,</div><div class="line">    password: <span class="string">'campus'</span>,</div><div class="line">    name: <span class="string">'패스트캠퍼스'</span>,</div><div class="line">    admin: <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">]</div><div class="line"></div><div class="line">app.use(cookieSession(&#123;</div><div class="line">  name: <span class="string">'session'</span>,</div><div class="line">  secret: process.env.SECRET</div><div class="line">&#125;))</div><div class="line"></div><div class="line">app.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (req.session.username) &#123;</div><div class="line">    req.user = res.locals.user = accounts.find(<span class="function"><span class="params">acc</span> =&gt;</span> acc.username === req.session.username)</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    req.user = res.locals.user = <span class="literal">null</span></div><div class="line">  &#125;</div><div class="line">  next()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</div><div class="line">  res.render(<span class="string">'index.ejs'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.post(<span class="string">'/login'</span>, urlencodedMiddleware, (req, res) =&gt; &#123;</div><div class="line">  <span class="keyword">const</span> account = accounts.find(<span class="function"><span class="params">acc</span> =&gt;</span> acc.username === req.body.username &amp;&amp; acc.password === req.body.password)</div><div class="line">  <span class="comment">// 인증 과정을 작성해주세요.</span></div><div class="line">  <span class="keyword">if</span>(account)&#123;</div><div class="line">    req.session.username = account.username</div><div class="line">    res.redirect(<span class="string">'/'</span>)  </div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    res.status(<span class="number">400</span>)</div><div class="line">    res.send(<span class="string">'400 Bad Request'</span>)</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">  </div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onlyAdminMiddleware</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">  <span class="comment">// `/secret`에 접속했을 때 이 미들웨어가 작동합니다.</span></div><div class="line">  <span class="comment">// 관리자가 아니면 403 Forbidden 응답을 보내도록 작성해주세요.</span></div><div class="line"></div><div class="line">  <span class="comment">// 위에서 req.session.username에 저장한 값을 통해 비교한다.</span></div><div class="line">  <span class="keyword">const</span> manage = accounts.find(<span class="function"><span class="params">acc</span> =&gt;</span> acc.username === req.session.username)</div><div class="line">  </div><div class="line">  <span class="keyword">if</span>(manage.admin == <span class="literal">true</span>)&#123;</div><div class="line">    <span class="comment">// next를 통하여 전달한다.</span></div><div class="line">    next()</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    res.status(<span class="number">403</span>)</div><div class="line">    res.send(<span class="string">'403 Forbidden'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">app.get(<span class="string">'/secret'</span>, onlyAdminMiddleware, (req, res) =&gt; &#123;</div><div class="line">  res.send(<span class="string">'It is my secret'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.post(<span class="string">'/logout'</span>, urlencodedMiddleware, (req, res) =&gt; &#123;</div><div class="line">  req.session = <span class="literal">null</span></div><div class="line">  res.redirect(<span class="string">'/'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'listening...'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<blockquote>
<p>MiddleWare에서는 성공시 next로 보내줘야한다.</p>
</blockquote>
<ul>
<li>session.sig을 통하여 session의 보안성이 지켜진다.</li>
</ul>

        </div>
        <footer class="article-footer">
            



    <a data-url="http://yoursite.com/2017/09/04/node-study-node-session/" data-id="cj9pll2n4002ydv6fq9w0xggi" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>follow:</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="google-plus" href="/tpwns1088@gmail.com" target="_blank">
                        <i class="icon fa fa-google-plus"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/KimSejune" target="_blank">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2017/09/04/node-study-node-cookie/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">newer</strong>
        <p class="article-nav-title">
        
            Node-Cookie
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2017/08/30/node-study-web-form/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">older</strong>
        <p class="article-nav-title">Node-Web-Form</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/10/27/node-study-elasticache/" class="thumbnail">
    
    
        <span style="background-image:url(/images/nodejs.png)" alt="Node-kue" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Node-js/">Node.js</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Node-js/Elasticache/">Elasticache</a></p>
                            <p class="item-title"><a href="/2017/10/27/node-study-elasticache/" class="title">Node-kue</a></p>
                            <p class="item-date"><time datetime="2017-10-27T03:54:00.000Z" itemprop="datePublished">2017-10-27</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/10/08/node-project-dada/" class="thumbnail">
    
    
        <span style="background-image:url(/images/wire-frame-1.png)" alt="Node-Project" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Project/">Project</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Project/ReadMe/">ReadMe</a></p>
                            <p class="item-title"><a href="/2017/10/08/node-project-dada/" class="title">Node-Project</a></p>
                            <p class="item-date"><time datetime="2017-10-08T03:54:00.000Z" itemprop="datePublished">2017-10-08</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/10/08/node-project-dada-redis/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Project/">Project</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Project/redis/">redis</a></p>
                            <p class="item-title"><a href="/2017/10/08/node-project-dada-redis/" class="title">Node-Project</a></p>
                            <p class="item-date"><time datetime="2017-10-08T03:54:00.000Z" itemprop="datePublished">2017-10-08</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/09/27/node-study-testablility/" class="thumbnail">
    
    
        <span style="background-image:url(/images/nodejs.png)" alt="Node-Testablility" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Node-js/">Node.js</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Node-js/Testablility/">Testablility</a></p>
                            <p class="item-title"><a href="/2017/09/27/node-study-testablility/" class="title">Node-Testablility</a></p>
                            <p class="item-date"><time datetime="2017-09-27T03:54:00.000Z" itemprop="datePublished">2017-09-27</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/09/26/node-linux-awsEC2/" class="thumbnail">
    
    
        <span style="background-image:url(/images/aws.png)" alt="Node-Linux-AWS(EC2)" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Node-js/">Node.js</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Node-js/Linux/">Linux</a></p>
                            <p class="item-title"><a href="/2017/09/26/node-linux-awsEC2/" class="title">Node-Linux-AWS(EC2)</a></p>
                            <p class="item-date"><time datetime="2017-09-26T03:54:00.000Z" itemprop="datePublished">2017-09-26</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/Selector/">Selector</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/Syntax/">Syntax</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">10</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Control-Flow/">Control Flow</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Data-Type/">Data-Type</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Function/">Function</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Immutability/">Immutability</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Introduction/">Introduction</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Object/">Object</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Operator/">Operator</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Prototype/">Prototype</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/Syntax/">Syntax</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/">Node.js</a><span class="category-list-count">34</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Ajax/">Ajax</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/CORS/">CORS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/CSRF/">CSRF</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Cookie/">Cookie</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/DataModeling/">DataModeling</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Database/">Database</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Elasticache/">Elasticache</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Express/">Express</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Express-Middlware/">Express-Middlware</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Fetch/">Fetch</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/GraphQL/">GraphQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Http/">Http</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/JWT/">JWT</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Linux/">Linux</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Linux/AWS/">AWS</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/OAuth/">OAuth</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Passport/">Passport</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Rest-API/">Rest-API</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/SPA/">SPA</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Service-Develop/">Service Develop</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Session/">Session</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/SocketIO/">SocketIO</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Template-Language/">Template Language</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Testablility/">Testablility</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/Web-Form/">Web Form</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/http-cache/">http-cache</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/knex/">knex</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/kue/">kue</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/mongoDB/">mongoDB</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Project/">Project</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Project/ReadMe/">ReadMe</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Project/redis/">redis</a><span class="category-list-count">1</span></li></ul></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">9</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWS/">AWS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ajax/">Ajax</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CORS/">CORS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSRF/">CSRF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Control-Flow/">Control Flow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cookie/">Cookie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Type/">Data-Type</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataModeling/">DataModeling</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Database/">Database</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticache/">Elasticache</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Express/">Express</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fetch/">Fetch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Function/">Function</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphQL/">GraphQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Http/">Http</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Immutability/">Immutability</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Introduction/">Introduction</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JWT/">JWT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Knex/">Knex</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Middleware/">Middleware</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a><span class="tag-list-count">36</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OAuth/">OAuth</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Object/">Object</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Operator/">Operator</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Passport/">Passport</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Prototype/">Prototype</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RestAPI/">RestAPI</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPA/">SPA</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Selector/">Selector</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Service-Develop/">Service Develop</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Session/">Session</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SocketIO/">SocketIO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Syntax/">Syntax</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Testablility/">Testablility</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web-Form/">Web Form</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cache/">cache</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kenx/">kenx</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kue/">kue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongoDB/">mongoDB</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/template-Language/">template Language</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/AWS/" style="font-size: 12px;">AWS</a> <a href="/tags/Ajax/" style="font-size: 10px;">Ajax</a> <a href="/tags/CORS/" style="font-size: 10px;">CORS</a> <a href="/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/tags/CSS/" style="font-size: 12px;">CSS</a> <a href="/tags/Control-Flow/" style="font-size: 10px;">Control Flow</a> <a href="/tags/Cookie/" style="font-size: 10px;">Cookie</a> <a href="/tags/Data-Type/" style="font-size: 10px;">Data-Type</a> <a href="/tags/DataModeling/" style="font-size: 10px;">DataModeling</a> <a href="/tags/Database/" style="font-size: 10px;">Database</a> <a href="/tags/Elasticache/" style="font-size: 10px;">Elasticache</a> <a href="/tags/Express/" style="font-size: 12px;">Express</a> <a href="/tags/Fetch/" style="font-size: 10px;">Fetch</a> <a href="/tags/Function/" style="font-size: 10px;">Function</a> <a href="/tags/GraphQL/" style="font-size: 10px;">GraphQL</a> <a href="/tags/Http/" style="font-size: 10px;">Http</a> <a href="/tags/Immutability/" style="font-size: 10px;">Immutability</a> <a href="/tags/Introduction/" style="font-size: 10px;">Introduction</a> <a href="/tags/JWT/" style="font-size: 10px;">JWT</a> <a href="/tags/JavaScript/" style="font-size: 18px;">JavaScript</a> <a href="/tags/Knex/" style="font-size: 12px;">Knex</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Middleware/" style="font-size: 10px;">Middleware</a> <a href="/tags/Node-js/" style="font-size: 20px;">Node.js</a> <a href="/tags/OAuth/" style="font-size: 10px;">OAuth</a> <a href="/tags/Object/" style="font-size: 10px;">Object</a> <a href="/tags/Operator/" style="font-size: 10px;">Operator</a> <a href="/tags/Passport/" style="font-size: 10px;">Passport</a> <a href="/tags/Prototype/" style="font-size: 10px;">Prototype</a> <a href="/tags/RestAPI/" style="font-size: 12px;">RestAPI</a> <a href="/tags/SPA/" style="font-size: 12px;">SPA</a> <a href="/tags/Selector/" style="font-size: 10px;">Selector</a> <a href="/tags/Service-Develop/" style="font-size: 10px;">Service Develop</a> <a href="/tags/Session/" style="font-size: 10px;">Session</a> <a href="/tags/SocketIO/" style="font-size: 10px;">SocketIO</a> <a href="/tags/Syntax/" style="font-size: 14px;">Syntax</a> <a href="/tags/Testablility/" style="font-size: 10px;">Testablility</a> <a href="/tags/Web-Form/" style="font-size: 10px;">Web Form</a> <a href="/tags/cache/" style="font-size: 10px;">cache</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/kenx/" style="font-size: 16px;">kenx</a> <a href="/tags/kue/" style="font-size: 10px;">kue</a> <a href="/tags/mongoDB/" style="font-size: 10px;">mongoDB</a> <a href="/tags/template-Language/" style="font-size: 10px;">template Language</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2017 Sejune kim</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'hexo-theme-hueman';
    
    
    var disqus_url = 'http://yoursite.com/2017/09/04/node-study-node-session/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>
